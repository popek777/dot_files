" 
" opera codebase settings, functions, commands
"

let g:c_like_files_extensions_csv='cpp,cc,h,hpp'

" build command
:command! -nargs=1 OperaBuild 
      \ :cgetexpr system('ninja -C ./chromium/src/out/Debug/ <args>')

" clang formatter path (variable used in clang-format.py script)
let g:clang_format_path = 
      \ $HOME . '/workspace/work/chromium/src/buildtools/linux64/clang-format'

" update cscope database (pure set of bash commands)
function! FOperaUpdateCscopeDb()
  :!cd $HOME/workspace/work
        \&& rm -f cscope*
        \ 
        \&& find . -name *.h -or
        \ -name *.hpp -or
        \ -name *.cc -or 
        \ -name *.cpp > cscope.files
        \
        \&& cscope -b -q -k
endfunction
:command! OperaUpdateCscopeDb :call FOperaUpdateCscopeDb()

" update ctags database 
" based on https://www.youtube.com/watch?v=o0BgAp11C9s
function! FOperaUpdateCtagsDb()
  :!cd $HOME/workspace/work
        \ && rm -f tags 
        \ 
        \ && ctags 
        \ --c++-kinds=+p 
        \ --fields=+iaS 
        \ --extra=+q 
        \ -f ./tags 
        \ -R
        \ --languages=C++ 
        \ --exclude=chromium/src/out/* 
        \ --exclude=chromium/src/third_party/*
        \ --exclude=chromium/src/build* 
        \ .
endfunction
:command! OperaUpdateCtagsDb :call FOperaUpdateCtagsDb()
